{
  "format_version": "1.0",
  "python_min": "3.10",
  "python_max": "3.12",
  "cuda_configs": {
    "cu124": {
      "cuda_driver_min": "12.4",
      "torch_index": "https://download.pytorch.org/whl/cu124",
      "packages": {
        "torch": "2.5.1+cu124",
        "torchvision": "0.20.1+cu124",
        "torchaudio": "2.5.1+cu124"
      }
    },
    "cu121": {
      "cuda_driver_min": "12.1",
      "torch_index": "https://download.pytorch.org/whl/cu121",
      "packages": {
        "torch": "2.5.1+cu121",
        "torchvision": "0.20.1+cu121",
        "torchaudio": "2.5.1+cu121"
      }
    },
    "cu118": {
      "cuda_driver_min": "11.8",
      "torch_index": "https://download.pytorch.org/whl/cu118",
      "packages": {
        "torch": "2.5.1+cu118",
        "torchvision": "0.20.1+cu118",
        "torchaudio": "2.5.1+cu118"
      }
    }
  },
  "core_dependencies": [
    {
      "name": "typing-extensions",
      "version": "4.12.2",
      "order": 0,
      "critical": false
    },
    {
      "name": "numpy",
      "version": "1.26.4",
      "order": 1,
      "critical": false
    },
    {
      "name": "torch",
      "version": "FROM_CUDA_CONFIG",
      "order": 2,
      "critical": true
    },
    {
      "name": "torchvision",
      "version": "FROM_CUDA_CONFIG",
      "order": 3,
      "critical": true
    },
    {
      "name": "torchaudio",
      "version": "FROM_CUDA_CONFIG",
      "order": 4,
      "critical": true
    },
    {
      "name": "transformers",
      "version": ">=4.51.0,<4.60.0",
      "order": 5,
      "critical": true
    },
    {
      "name": "tokenizers",
      "version": ">=0.21.0,<0.24.0",
      "order": 6,
      "critical": true
    },
    {
      "name": "safetensors",
      "version": ">=0.7.0,<0.8.0",
      "order": 7,
      "critical": false
    },
    {
      "name": "huggingface-hub",
      "version": ">=0.27.0,<0.28.0",
      "order": 8,
      "critical": false
    },
    {
      "name": "peft",
      "version": ">=0.13.0,<0.16.0",
      "order": 9,
      "critical": true
    },
    {
      "name": "accelerate",
      "version": ">=1.2.0,<1.3.0",
      "order": 10,
      "critical": true
    },
    {
      "name": "bitsandbytes",
      "version": ">=0.45.0,<0.50.0",
      "order": 11,
      "critical": false
    },
    {
      "name": "datasets",
      "version": ">=3.2.0,<4.0.0",
      "order": 12,
      "critical": false
    },
    {
      "name": "PySide6",
      "version": "6.8.1",
      "order": 13,
      "critical": true
    },
    {
      "name": "PySide6-Essentials",
      "version": "6.8.1",
      "order": 14,
      "critical": true
    },
    {
      "name": "PySide6-Addons",
      "version": "6.8.1",
      "order": 15,
      "critical": true
    },
    {
      "name": "shiboken6",
      "version": "6.8.1",
      "order": 16,
      "critical": true
    },
    {
      "name": "sympy",
      "version": "1.13.1",
      "order": 17,
      "critical": false
    },
    {
      "name": "jinja2",
      "version": "3.1.6",
      "order": 18,
      "critical": false
    },
    {
      "name": "fsspec",
      "version": "2025.9.0",
      "order": 19,
      "critical": false
    },
    {
      "name": "filelock",
      "version": "3.20.1",
      "order": 20,
      "critical": false
    },
    {
      "name": "mpmath",
      "version": "1.3.0",
      "order": 21,
      "critical": false
    },
    {
      "name": "regex",
      "version": "2024.11.6",
      "order": 22,
      "critical": false
    },
    {
      "name": "pyyaml",
      "version": "6.0.2",
      "order": 23,
      "critical": false
    },
    {
      "name": "requests",
      "version": "2.32.3",
      "order": 24,
      "critical": false
    },
    {
      "name": "packaging",
      "version": "24.2",
      "order": 25,
      "critical": false
    },
    {
      "name": "tqdm",
      "version": "4.67.1",
      "order": 26,
      "critical": false
    },
    {
      "name": "sentencepiece",
      "version": "0.2.0",
      "order": 27,
      "critical": false
    },
    {
      "name": "evaluate",
      "version": "0.4.3",
      "order": 28,
      "critical": false
    },
    {
      "name": "einops",
      "version": "0.8.1",
      "order": 29,
      "critical": false
    },
    {
      "name": "timm",
      "version": "1.0.12",
      "order": 30,
      "critical": false
    },
    {
      "name": "open-clip-torch",
      "version": "2.29.0",
      "order": 31,
      "critical": false
    },
    {
      "name": "pandas",
      "version": "2.2.3",
      "order": 32,
      "critical": false
    },
    {
      "name": "psutil",
      "version": "7.2.0",
      "order": 33,
      "critical": false
    },
    {
      "name": "streamlit",
      "version": "1.41.1",
      "order": 34,
      "critical": false
    },
    {
      "name": "uvicorn",
      "version": ">=0.30.0,<1.0.0",
      "order": 35,
      "critical": true
    },
    {
      "name": "fastapi",
      "version": ">=0.115.0,<1.0.0",
      "order": 36,
      "critical": true
    },
    {
      "name": "pydantic",
      "version": ">=2.0.0,<3.0.0",
      "order": 37,
      "critical": true
    }
  ],
  "optional_packages": [
    {
      "name": "unsloth",
      "version": ">=2024.11",
      "blacklist_deps": [
        "torchao",
        "pytorch-ao",
        "torchao-nightly"
      ],
      "skip_reason": "unsloth requires torchao which conflicts with our environment",
      "comment": "DO NOT INSTALL - causes transformers import failures"
    },
    {
      "name": "xformers",
      "version": ">=0.0.27",
      "comment": "Memory-efficient attention - optional optimization"
    }
  ],
  "global_blacklist": [
    "torchao",
    "pytorch-ao",
    "torchao-nightly",
    "torch-ao"
  ],
  "verification_tests": [
    {
      "name": "torch_cuda",
      "code": "import torch; assert torch.cuda.is_available(), 'CUDA not available'; print(f'torch {torch.__version__} with CUDA {torch.version.cuda}')",
      "critical": true
    },
    {
      "name": "transformers_import",
      "code": "from transformers import PreTrainedModel, AutoModel, AutoTokenizer; print('transformers imports OK')",
      "critical": true
    },
    {
      "name": "peft_import",
      "code": "import peft; from peft import get_peft_model, LoraConfig; print('peft OK')",
      "critical": true
    },
    {
      "name": "datasets_import",
      "code": "import datasets; print('datasets OK')",
      "critical": true
    },
    {
      "name": "bitsandbytes_import",
      "code": "import bitsandbytes; print('bitsandbytes OK')",
      "critical": false
    },
    {
      "name": "no_blacklisted",
      "code": "import sys, importlib.util; blacklist=['torchao', 'pytorch_ao']; found=[pkg for pkg in blacklist if importlib.util.find_spec(pkg) is not None]; assert not found, f'Blacklisted packages found: {found}'; print('No blacklisted packages')",
      "critical": true
    }
  ],
  "post_install_cleanup": [
    {
      "action": "clear_pycache",
      "path": "site-packages",
      "recursive": true,
      "reason": "Prevent lazy_loader corruption"
    },
    {
      "action": "verify_no_blacklist",
      "packages": [
        "torchao",
        "pytorch-ao",
        "torchao-nightly"
      ],
      "fail_on_found": true
    }
  ]
}
